Configuring installation paths

The framework needs the paths to relevant data and programs. There are two ways to pass this information; in both cases, shell variables beginning with ‘$’ will be expanded at run time, so you can specify, eg, “$HOME/dir_name” or “$TMPDIR”. As an example, we’ll show how to set the value of OUTPUT_DIR to “$HOME/mdtf_out”.
As long-form command-line options; you’d run the framework as
% $CODE_ROOT/mdtf --OUTPUT_DIR $HOME/dir_name [... other options...]
Editing the configuration defaults. These are set in a commented JSON file in $CODE_ROOT/src/defaults.jsonc (which define the command-line options.)
If you didn’t clone the git repo, you can edit this file directly. In the example, you’d find the entry containing “name”: “OUTPUT_DIR”, and change the line in that entry beginning with “default” to read “default”: “$HOME/dir_name”. Other lines in the entry shouldn’t be changed.
If you cloned the git repo, you will have to be careful to not commit the changes to this file. A less fragile way to do this is to make the above changes to a copy of $CODE_ROOT/src/defaults.jsonc, and specify this when running the framework as
 % $CODE_ROOT/mdtf -f my_defaults.jsonc [... other options...]
Options set explicitly on the command line always override those set in a copied defaults file (set with -f above), if present, and options in that file override those in the framework’s defaults.jsonc.

Paths that you should consider configuring are:

MODEL_DATA_ROOT: path to the sample model data downloaded in step 1.2. If you didn’t rename directories, this would end in “.../inputdata/model”.
OBS_DATA_ROOT: path to the supporting observational data downloaded in step 1.2. If you didn’t rename directories, this would end in “.../inputdata/obs_data”.
WORKING_DIR: Parent directory the framework will use for downloading remotely-stored data (when not using the sample data) and collecting POD output. 
OUTPUT_DIR: Parent directory that the framework will copy finished results to. By default, results of different runs are given unique names so that your data is never overwritten.
conda_root: Only used in conda-based installations. Location of your conda installation. The framework will attempt to determine this automatically if not specified, but due to technical issues with conda it’s recommended you set this manually. Set this path to the value returned by running
% conda info --base
conda_env_root: Only used in conda-based installations. If you chose to install the MDTF conda environments in a custom location in step 2.2, this should be set to the value of $ENV_DIR you used. If you didn’t use a custom location, this should be set to the empty string “”.
venv_root: Only used in non-conda-based installations. Directory where the framework should create python virtualenvs.
r_lib_root: Only used in non-conda-based installations. Directory where the framework should install user R libraries.

5.  Modifying package settings 
Changes from v2.0:  The “defaults.jsonc” file and the command-line options it defines replace the previous namelist file format. 

See section 3.2 for how to set command-line flags, and optionally how to change their default values by modifying the src/default.jsonc file. In addition to the paths listed in that section, other useful settings are:

save_ps: set to “true” to retain the vector .eps figures generated by PODs, in addition to the bitmap images linked to from the webpage.
save_nc: set to “true” to retain netcdf files of any raw output data saved by PODs for further analysis.
make_variab_tar: set to “true” to save the entire output directory as a .tar file, for archival or file transfer purposes.
overwrite: set to “true” to overwrite previous framework output in $OUTPUT_DIR. By default, output with the same CASENAME and date range is assigned a unique name to ensure preexisting results are never overwritten.

As with the paths, these can be set as command-line flags each time the framework is run, or (if not present on the command line) according to their default values in defaults.jsonc.
